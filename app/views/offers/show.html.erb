<h1>申込の詳細</h1>

<% if @offer.status == 1 %>
    <% if current_user.user_type != 3 %>

    <ul>
        <li>タイトル：<%= @ticket.title %></li>
        <li>申込日時：<%= @offer.created_at.strftime("%Y年%m月%d日 %H時%M分") %></li>
        <li>場所：<%= @offer.area %> <%= @offer.place %></li>
        <li>日程：<%= @offer.meet_at.strftime("%Y年%m月%d日 %H時%M分") %>から<%= @offer.length %>時間</li>
        <li>支払額：<%= number_to_currency(@offer.price) %></li>
        <li>メッセージ：<br /><%= simple_format(h(@offer.message)) %></li>
    </ul>

    <p>サポーターの承認待ちです。メッセージをやりとりして調整を進めましょう。</p>

    <% else %>

    <ul>
        <%= form_for(@offer) do |f| %>
        <li>タイトル：<%= @ticket.title %></li>
        <li>申込日時：<%= @offer.created_at.strftime("%Y年%m月%d日 %H時%M分") %></li>
        <li>場所：<%= @offer.area %> <%= f.text_field :place %></li>
        <li>日程：<%= f.datetime_select :meet_at, step: 30 %>から<%= f.select :length, @hour %>時間</li>
        <li>料金：<%= f.select :price, @price %>円</li>
        <li>手数料割合：<%= f.select :rate, [['30%', 30],['40%', 40],['50%', 50],['60%', 60],['70%', 70],['80%', 80],['90%', 90],['100%', 100]] %></li>
        <li>メッセージ：<br /><%= simple_format(h(@offer.message)) %></li>
        <li><%= f.submit('条件を更新') %> <%= f.submit('条件を承認') %> <%= f.submit('申込を断る') %>
        <% end %>
    </ul>

    <p>変更すると申込者に変更通知が届きます。</p>

    <% end %>

<% elsif @offer.status == 2 %>

    <ul>
        <li>タイトル：<%= @ticket.title %></li>
        <li>申込日時：<%= @offer.created_at.strftime("%Y年%m月%d日 %H時%M分") %></li>
        <li>場所：<%= @offer.area %> <%= @offer.place %></li>
        <li>日程：<%= @offer.meet_at.strftime("%Y年%m月%d日 %H時%M分") %>から<%= @offer.length %>時間</li>
        <li>支払額：<%= number_to_currency(@offer.price) %></li>
        <li>メッセージ：<br /><%= simple_format(h(@offer.message)) %></li>
    </ul>

    <% if current_user.user_type != 3 %>

        <%= form_for(@offer) do |f| %>
            <%= f.submit('申込を確定') %>
            <%= f.submit('再調整依頼') %>
            <%= f.submit('申込を削除') %>
        <% end %>

    <% else %>
        <p>申込者の確認待ちです。</p>
    <% end %>

<% else %>

    <h2>過去の申込履歴</h2>
    <ul>
        <li>タイトル：<%= @ticket.title %></li>
        <li>申込日時：<%= @offer.created_at.strftime("%Y年%m月%d日 %H時%M分") %></li>
        <li>成立日時：<%= @offer.updated_at.strftime("%Y年%m月%d日 %H時%M分") %></li>
        <li>場所：<%= @offer.area %> <%= @offer.place %></li>
        <li>日程：<%= @offer.meet_at.strftime("%Y年%m月%d日 %H時%M分") %>から<%= @offer.length %>時間</li>
        <li>支払額：<%= number_to_currency(@offer.price) %></li>
        <% if current_user.user_type == 3 %>
        <li>手数料割合：<%= number_to_percentage(@ticket.rate, precision: 0) %></li>
        <% end %>
        <li>メッセージ：<br /><%= simple_format(h(@offer.message)) %></li>
    </ul>

<% end %>